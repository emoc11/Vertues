$(function(){function e(){return i.width()>1024}function s(e){$menuLink.each(function(){var s=$(this),n=$(s.attr("href"));n.position().top-r<e+100&&n.position().top+n.height()>e?($menuLink.removeClass("is-active").blur(),s.addClass("is-active")):s.removeClass("is-active")})}function n(s,n){if(e())if(s<menuPosition-20)t.css("padding-top",0),$menu.removeClass("sticky"),clickedOnMenu||($menuToggle.addClass("on"),TweenMax.to($menuList,.5,{left:0,ease:Quad.easeOut})),$(".accueil-foret").css("top","10px");else{t.css("padding-top",r),$menu.addClass("sticky"),$menuToggle.removeClass("on"),TweenMax.to($menuList,.5,{left:-560,ease:Quad.easeOut});var i=10-parseInt(r)+"px";$(".accueil-foret").css("top",i)}else $menu.addClass("sticky"),t.hasClass("home")&&t.css("padding-top","90px")}var i=$(window),t=$("body"),o=$("#accueil");$menu=$(".menu"),$menuToggle=$(".menu-toggle"),$menuList=$(".menu-list"),$menuLink=$(".menu-link");var a=i.scrollTop(),l=a,c=e(),r=$menu.outerHeight(!0);if(menuPosition=o.height(),clickedOnMenu=!1,clickedMenuLink=!1,$menuToggle.on("click",function(){if(clickedOnMenu=!0,$(this).toggleClass("on"),e()){var s=$(this).hasClass("on")?0:"-560px";TweenMax.to($menuList,.5,{left:s,ease:Quad.easeOut})}else $menuList.slideToggle()}),i.on({scroll:function(){a=$(this).scrollTop(),r=$menu.outerHeight(!0),$(".home").length&&(clickedMenuLink||s(a),n(a,l)),l=a},resize:function(){a=$(this).scrollTop(),r=$menu.outerHeight(!0),menuPosition=o.height(),!e()&&c?($menuToggle.removeClass("on"),$menuList.slideUp()):e()&&!c&&(clickedOnMenu=!1,$menuToggle.addClass("on"),$menuList.slideDown(),TweenMax.to($menuList,.5,{left:0,ease:Quad.easeOut})),$(".home").length&&n(a,l),c=e()}}),$("a[href*='#']").on("click",function(e){clickedMenuLink=!0,e.preventDefault(),$menuLink.removeClass("is-active"),$(this).addClass("is-active");var s=$(this).attr("href");$("body, html").stop().animate({scrollTop:$(s).offset().top-r},function(){setTimeout(function(){clickedMenuLink=!1},100)})}),$("#sendForm").submit(function(e){e.preventDefault();var s=$("#sendForm input[name='nom']").val(),n=$("#sendForm input[name='prenom']").val(),i=$("#sendForm input[name='email']").val(),t=$("#sendForm input[name='societe']").val(),o=$("#sendForm textarea[name='message']").val(),a={nom:s,prenom:n,email:i,societe:t,message:o,encode:!0};$.ajax({url:"php/send_mail.php",method:"POST",data:a,dataType:"json"}).done(function(e){$(".popinForm .msg").text(e.response),$(".popinForm").fadeIn("slow")}).fail(function(e){console.log("FORM AJAX FAILED"),console.log(e),$(".popinForm .msg").text('Une erreur est survenue. Veuillez nous excuser pour la gêne occasionnée. Si ce problème persiste, merci de nous contacter directement à l\'adresse <a href="mailto:vertues_contact@gmail.com">vertues_contact@gmail.com</a>.'),$(".popinForm").fadeIn("slow")})}),$(".membre-illu-wrapper").on({touchstart:function(){$(this).mouseenter()},touchend:function(){$(this).mouseout()}}),$(".popinForm .close").bind("click",function(){$(".popinForm").fadeOut("slow")}),$(".popinForm").bind("click",function(){$(".popinForm").fadeOut("slow")}),$(".popinForm .in_popin").bind("click",function(e){e.stopPropagation(),e.preventDefault()}),i.trigger("scroll"),e()||($menuList.slideUp(),$menuToggle.removeClass("on")),$(".formulaire").length){var u=$(".body-part");universName="",smell1="",smell2="",univers=[{src:"cascade",name:"Cascade",description:["Pierre mouillée","Humidité"]},{src:"desert",name:"Désert",description:["Arbres du désert","Sable"]},{src:"foret",name:"Forêt",description:["Sapin","Eucapalyptus"]},{src:"ocean",name:"Océan",description:["Vagues","Ecumes"]},{src:"campagne",name:"Campagne",description:["Champs","Fleurs"]},{src:"plage",name:"Plage",description:["Flammes","Bois brûlé"]}],$(".question-next").on("click",function(e){if($(this).hasClass("question-finish")||e.preventDefault(),!$(this).hasClass("blocked")){var s=$(this).attr("href");$(".question:visible").hide("fade",{duration:400},function(){$("#selected-parfum").addClass("blocked"),$(s).show("fade",{duration:400}).addClass("is-active")})}}),$("#question-1 .choices-item").on("click",function(){$("#question-1 .question-next").removeClass("blocked");var e=univers[parseInt($(this).data("univers"))];universName=e.name,smell1=e.description[0],smell2=e.description[1]}),$("#show-small-list").on("click",function(){$(this).addClass("button-blue").removeClass("button--transparent"),$("#hide-small-list").removeClass("button-blue").addClass("button--transparent"),$("#list-univers").show(200),$("#selected-parfum").addClass("blocked")}),$("#hide-small-list").on("click",function(){$(this).addClass("button-blue").removeClass("button--transparent"),$("#show-small-list").removeClass("button-blue").addClass("button--transparent"),$("#list-univers").hide(200),$("#selected-parfum").removeClass("blocked")}),$("#question-2 .choices-item").on("click",function(){$("#selected-parfum").removeClass("blocked"),smell1=univers[parseInt($(this).data("univers"))].description[0],smell2=univers[parseInt($(this).data("univers"))].description[1]}),$(".choices-description li").on({click:function(){$("#question-3 .question-next").removeClass("blocked"),$(".choices-description li").removeClass("selected"),$(this).addClass("selected");var e=$(this).data("images");e.length>1?u.addClass("is-active"):($(".body-part:not(#body-"+e+")").removeClass("is-active"),$("#body-"+e).addClass("is-active"))},mouseenter:function(){var e=$(this).data("images");e.length>1?u.css("opacity",1):"0"==e?u.css("opacity",0):($(".body-part:not(#body-"+e+")").css("opacity",0),$("#body-"+e).css("opacity",1))},mouseleave:function(){$(this).data("images");$(".body-part:not(.is-active)").css("opacity",0),$(".body-part.is-active").css("opacity",1)}}),$("#question-4 .choices-button").on("click",function(){$(this).toggleClass("button--transparent button--blue")}),$(".choices-item").on("click",function(){if($.inArray($(this).closest("section").attr("id"),["question-3","question-4"])>-1)return!1;var e=$(this).data("univers");$(".choices-item").removeClass("is-active"),$(".choices-item[data-univers="+e+"]").addClass("is-active");var s="img/univers_"+univers[e].src+".jpg",n=univers[e].name,i=univers[e].description,t=$("#question-2 .choices-item--center");t.find(".choices-illu").attr("src",s),t.find(".choices-name").text(n);var o="";$.each(i,function(e,s){o+="<li><p>"+s+"</p></li>"}),t.find(".choices-description").empty().html(o),$("#final-univers-name").text(universName),$("#final-univers-odeur-1").text(smell1),$("#final-univers-odeur-2").text(smell2)});var m=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;$("#field-email").on("keyup",function(){$(this).val().length>2&&m.test($(this).val())?$("#question-5 .question-next").removeClass("blocked"):$("#question-5 .question-next").addClass("blocked")})}});